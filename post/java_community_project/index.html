<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  
    class="html theme--light"
  
><head>
  <title>
    
      
        Adelaide CS Community Project |
      JZ Chan

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.68.3" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="JZ Chan" />
  <meta
    name="description"
    content="Jian Zhe (JZ) Chan
Student from The University of Adelaide
Penultimate Computer Science Undergraduate
------------- SKILLS -------------
C&#43;&#43; | C | C# | Python 
R | MATLAB | Visual Studio
HTML | CSS | JavaScript | Vue.js | React.js 
Node.js | AJAX | MySQL
Git | Linux
"
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.ba004976221e613a16542d07a2deca5d0377ff5e6a22dec5fcec01480ba967cf.css"
      integrity="sha256-ugBJdiIeYToWVC0Hot7KXQN3/15qIt7F/OwBSAupZ88="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.793b323d7f2d9fbfd0b93f4d593fb5ad77b918716ed33eddea403fa87f770403.css"
    integrity="sha256-eTsyPX8tn7/QuT9NWT&#43;1rXe5GHFu0z7d6kA/qH93BAM="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://chanjz.github.io/post/java_community_project/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.5c846cefa5ed21cceee981c70901aaf21b17b4e0b05bd777af840780918abea9.js"
    integrity="sha256-XIRs76XtIczu6YHHCQGq8hsXtOCwW9d3r4QHgJGKvqk="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.46e991c2fcb035fc0060a792f1eb0c93ecacc9e76cd7445d6531a5cf2928686d.js"
      integrity="sha256-RumRwvywNfwAYKeS8esMk&#43;ysyeds10RdZTGlzykoaG0="
      crossorigin="anonymous"
    ></script>
  

  


  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://chanjz.github.io/images/main.png"/>

<meta name="twitter:title" content="Adelaide CS Community Project"/>
<meta name="twitter:description" content="When I first knew Garbage Collection Mechanism in Java, I felt it was quite appealing to me, especially for a C&#43;&#43; programmer, because I do not need to worry about the memory leak anymore; therefore I started learning Java in April 2022. On December 22, 2022, I started my Java full-stack project. This post will keep track of my progress of developing this project."/>



  
  <meta property="og:title" content="Adelaide CS Community Project" />
<meta property="og:description" content="When I first knew Garbage Collection Mechanism in Java, I felt it was quite appealing to me, especially for a C&#43;&#43; programmer, because I do not need to worry about the memory leak anymore; therefore I started learning Java in April 2022. On December 22, 2022, I started my Java full-stack project. This post will keep track of my progress of developing this project." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chanjz.github.io/post/java_community_project/" />
<meta property="og:image" content="https://chanjz.github.io/images/main.png"/>
<meta property="article:published_time" content="2023-02-16T10:08:09+10:30" />
<meta property="article:modified_time" content="2023-02-16T10:08:09+10:30" /><meta property="og:site_name" content="My blog" />



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "post",
        "name": "Adelaide CS Community Project",
        "headline": "Adelaide CS Community Project",
        "alternativeHeadline": "",
        "description": "
      
        \x3cp\x3eWhen I first knew Garbage Collection Mechanism in Java, I felt it was quite appealing to me, especially for a C\x2b\x2b programmer, because I do not need to worry about the memory leak anymore; therefore I started learning Java in April 2022. On December 22, 2022, I started my Java full-stack project. This post will keep track of my progress of developing this project.\x3c\/p\x3e


      


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/chanjz.github.io\/post\/java_community_project\/"
        },
        "author" : {
            "@type": "Person",
            "name": "JZ Chan"
        },
        "creator" : {
            "@type": "Person",
            "name": "JZ Chan"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "JZ Chan"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "JZ Chan"
        },
        "copyrightYear" : "2023",
        "dateCreated": "2023-02-16T10:08:09.00Z",
        "datePublished": "2023-02-16T10:08:09.00Z",
        "dateModified": "2023-02-16T10:08:09.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "JZ Chan",
            "url": "https://chanjz.github.io/",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/chanjz.github.io\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://chanjz.github.io/images/main.png"


      
      ]

    ,
        "url" : "https:\/\/chanjz.github.io\/post\/java_community_project\/",
        "wordCount" : "6369",
        "genre" : [ ],
        "keywords" : [ 
      
      "Java"

    
      
        ,

      
      "Project"

    ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/main.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">My blog</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Jian Zhe (JZ) Chan<br />Student from The University of Adelaide<br />Penultimate Computer Science Undergraduate<br />------------- SKILLS -------------<br />C++ | C | C# | Python <br />R | MATLAB | Visual Studio<br />HTML | CSS | JavaScript | Vue.js | React.js <br />Node.js | AJAX | MySQL<br />Git | Linux<br /></p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="mailto:chanjianzhe2002@gmail.com"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://www.linkedin.com/in/jian-zhe-chan-999b85235/"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/Chan-JZ"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://api.whatsapp.com/send?phone=61452633511"
            target="_blank"
            rel="noopener me"
            aria-label="WhatsApp"
            title="WhatsApp"
          >
            <i class="fab fa-whatsapp fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        JZ Chan
        2023
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.7d3bf3472b73d9ba107b3de37d0df8fa736593a3c6638c95eaed42006bfc0193.js"
    integrity="sha256-fTvzRytz2boQez3jfQ34&#43;nNlk6PGY4yV6u1CAGv8AZM="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/post/"
              
              title=""
              >Posts</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/portfolio/"
              
              title=""
              >Portfolio</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/awards/"
              
              title=""
              >Awards</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/certifications/"
              
              title=""
              >Certifications</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>Adelaide CS Community Project</h1>
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                
                  16/2/2023
                

              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text">30-minute read</span>
          </li>
        </ul>
      <p>When I first knew Garbage Collection Mechanism in Java, I felt it was quite appealing to me, especially for a C++ programmer, because I do not need to worry about the memory leak anymore; therefore I started learning Java in April 2022. On December 22, 2022, I started my Java full-stack project. This post will keep track of my progress of developing this project.</p>
<p><br /></p>
<h2 id="2023-02-19">2023-02-19</h2>
<h4 id="introduction-to-elasticsearch">Introduction to Elasticsearch</h4>
<ul>
<li>Elasticsearch is a distributed, free and open search and analytics engine for all types of data, including textual, numerical, geospatial, structured, and unstructured. Elasticsearch is built on Apache Lucene and was first released in 2010 by Elasticsearch N.V. (now known as Elastic).</li>
<li>Elasticsearch Keywords
<ul>
<li>Index: equals to a table of database</li>
<li>Document: equals to one row of data (json format)</li>
<li>Field: equals to one column type of table</li>
<li>Cluster: one or more server</li>
<li>Node: one server of the cluster</li>
<li>Slice: segment of an index</li>
<li>Copy: back-up for slices (one slice can have many copies)</li>
</ul>
</li>
<li>Install Elasticsearch
<ul>
<li>brew install elastic/tap/elasticsearch-full</li>
</ul>
</li>
<li>Check the status of cluster
<ul>
<li>curl -X GET &ldquo;localhost:9200/_cat/health?v&rdquo;</li>
</ul>
</li>
<li>Check the number of index
<ul>
<li>curl -X GET &ldquo;localhost:9200/_cat/indices?v&rdquo;</li>
</ul>
</li>
<li>Create an index
<ul>
<li>curl -X PUT &ldquo;localhost:9200/test&rdquo;</li>
</ul>
</li>
<li>Detele an index
<ul>
<li>curl -X DELETE &ldquo;localhost:9200/test&rdquo;</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-02-18">2023-02-18</h2>
<h4 id="displaying-specific-system-notifications">Displaying specific system notifications</h4>
<ul>
<li>Get all notifications of a specific topic</li>
<li>Display the total number of unread messages using interceptor (messages + notifications)</li>
</ul>
<p><br /></p>
<h2 id="2023-02-17">2023-02-17</h2>
<h4 id="displaying-system-notifications">Displaying system notifications</h4>
<ul>
<li>Display three types of system notifications: comment, up-vote, and follow.</li>
<li>Count the number of unread messages</li>
<li>Implementation
<ul>
<li>Get the latest notification for one topic</li>
<li>Get the number of notifications for one topic</li>
<li>Get the number of unread notifications for one topic</li>
</ul>
</li>
</ul>
<p><mark>Trouble Shooting:</mark></p>
<ul>
<li>Issue: ParseException: Exception evaluating SpringEL expression: &ldquo;followNotice.message!=null&rdquo;
<ul>
<li>I spent around 2 hours in solving this bug. In my back-end implementation, if there is no following system notice, then an empty followNotice view object map will be added to the attribute of the template. Therefore, when the front-end trying to access <strong>followNotice.message</strong>, the issue will arise.</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-02-16">2023-02-16</h2>
<h4 id="sending-system-notifications">Sending system notifications</h4>
<ul>
<li>Trigger events: After commenting, up-voting, following</li>
<li>Handle events: Encapsulate event objects, develop producer, develop consumer</li>
<li>Invoke event producer in <strong>CommentController</strong>, <strong>LikeController</strong>, and <strong>FollowController</strong></li>
</ul>
<p><mark>Trouble Shooting:</mark></p>
<ul>
<li>Issue: IllegalArgumentException: XML fragments parsed from previous mappers already contains value for *
<ul>
<li>I spent 2.5 hours on solving this issue. After some research, I know there are two ways of causing this issue:
<ul>
<li>In the mapper file, there are duplicated method ids</li>
<li>In the mapper file, method parameters are incorrect</li>
</ul>
</li>
<li>However, I checked these two rules for a while and did not find anything incorrect. And then, one post online said that in the extreme case, the problem of IDEA could cause this issue. Therefore, I cleaned and installed my maven project manually, and solved this bug in the end.</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-02-14">2023-02-14</h2>
<h4 id="kafka---building-terabyte-scale-asynchronous-messaging-systems">Kafka - Building terabyte-scale asynchronous messaging systems</h4>
<ul>
<li>Kafka is a distributed streaming platform</li>
<li>Applications: messaging systems, log collection, user behavior tracking, stream processing</li>
<li>Features: high throughput, message persistence, high reliability, high scalability</li>
<li>Kafka keywords
<ul>
<li>Broker: Kafka server</li>
<li>Zookeeper: An application to manage Kafka clusters</li>
<li>Topic: The place where the producer puts the data in (A container for data)</li>
<li>Partition: Segmentation for topic space (To boost concurrency capability)</li>
<li>Offset: The index of a message in the partition</li>
<li>Leader Replica: Main Back-up for data (When consumer requests for data, leader replica can respond)</li>
<li>Follower Replica: Back-up for data (Just back-up)</li>
</ul>
</li>
<li>Install Kafka
<ul>
<li>brew install kafka</li>
</ul>
</li>
<li>Start Zookeeper and Kafka
<ul>
<li>zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties</li>
<li>kafka-server-start /usr/local/etc/kafka/server.properties</li>
</ul>
</li>
<li>Create a topic
<ul>
<li>kafka-topics - -create - -bootstrap-server localhost:9092 - -replication-factor 1 - -partitions 1 - -topic test</li>
</ul>
</li>
<li>Check the list of topics at a specific server and port
<ul>
<li>kafka-topics - -list - -bootstrap-server localhost:9092</li>
</ul>
</li>
<li>Put messages into Kafka
<ul>
<li>kafka-console-producer - -broker-list localhost:9092 - -topic test</li>
<li>After seeing <em>&gt;</em>, we can put messages into Kafka</li>
</ul>
</li>
<li>Take messages from Kafka
<ul>
<li>kafka-console-consumer - -bootstrap-server localhost:9092 - -topic test - -from-beginning</li>
</ul>
</li>
</ul>
<img src="/JavaCommunity/Kafka.png" width="600"/>
<h4 id="introduction-to-blocking-queue">Introduction to blocking queue</h4>
<ul>
<li>BlockingQueue
<ul>
<li>Solving problems with threaded communication</li>
<li>Blocking methods: put(), take()</li>
</ul>
</li>
<li>Producer-consumer mode
<ul>
<li>Producer: thread that produces data</li>
<li>Consumer: thread that consumes data</li>
</ul>
</li>
<li>Implementation class
<ul>
<li>ArrayBlockingQueue</li>
<li>LinkedBlockingQueue</li>
<li>PriorityBlockingQueue, SynchronousQueue, DelayQueue</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-02-11">2023-02-11</h2>
<h4 id="optimize-login-module">Optimize login module</h4>
<ul>
<li>Using redis to store captcha
<ul>
<li>Reason
<ul>
<li>Captcha requires constant access and refresh</li>
<li>Captcha does not need to be stored permanently, it will expire after a short period of time</li>
<li>There will be some problems about session sharing when it comes to distributed system</li>
</ul>
</li>
<li>Implementation
<ul>
<li>Define redis key which consists of a random generated string called &lsquo;captcha owner&rsquo;</li>
<li>Refactor method <strong>getKaptcha()</strong> from <strong>LoginController</strong> to store the generated captcha into redis</li>
<li>Refactor method <strong>login()</strong> from <strong>LoginController</strong> to get the generated captcha from redis and verify it
<ul>
<li>To get the redisKey, we will get the captcha owner from cookies</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Using redis to store login session
<ul>
<li>Reason
<ul>
<li>We need to frequently check the login session every time when handling some requests</li>
</ul>
</li>
<li>Implementation
<ul>
<li>Define redis key for login ticket</li>
<li>Refactor method <strong>login()</strong> from <strong>UserService</strong> to store the login ticket into redis</li>
<li>Refactor method <strong>logout()</strong> from <strong>UserService</strong> to destroy the login ticket when users log out</li>
<li>Refactor method <strong>findLoginTicket()</strong> from <strong>UserService</strong> to get the login ticket from redis</li>
</ul>
</li>
</ul>
</li>
<li>Using redis to store the user information
<ul>
<li>Reason
<ul>
<li>We need to frequently check the user information based on the login session every time when handling some requests</li>
</ul>
</li>
<li>Logic
<ul>
<li>Check if the data we want is stored in redis or not, if not, access database and store that data into redis</li>
</ul>
</li>
<li>Implementation
<ul>
<li>Define 3 methods called <strong>getCache()</strong>, <strong>initCache()</strong>, <strong>clearCache()</strong></li>
<li>Put these 3 methods into other methods that will update the user information</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-02-02">2023-02-02</h2>
<h4 id="following-list-and-follower-list">Following list and follower list</h4>
<ul>
<li>Go to <strong>FollowService</strong>
<ul>
<li>Define a method called <strong>findFollowees()</strong> to get the followees of a user. (It contains the follower and the time of following)</li>
<li>Define a method called <strong>findFollowers()</strong> to get the followers of a user.</li>
</ul>
</li>
<li>Go to <strong>FollowController</strong>
<ul>
<li>Define a method called <strong>getFollowees()</strong>
<ul>
<li>Check if the current logged in user has followed those followees or not.</li>
</ul>
</li>
<li>Define a method called <strong>getFollowers()</strong></li>
</ul>
</li>
<li>Connect with the frontend page</li>
</ul>
<p><mark>Trouble Shooting:</mark></p>
<ul>
<li>Issue: The user profile page does not show the correct number of followees
<ul>
<li>Cause: In the FollowService, I used <strong>RedisKeyUtil.getFollowerKey()</strong> instead of <strong>RedisKeyUtil.getFolloweeKey()</strong></li>
</ul>
</li>
<li>Issue: In the followee list, I cannot unfollow users
<ul>
<li>Solve: Add the label of <em>input type=&quot;hidden&rdquo; id=&quot;entityId&rdquo; th:value=&quot;${map.user.id}&quot;</em> so that the javascript file can get the entityId</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-31">2023-01-31</h2>
<h4 id="follower-and-following">Follower and following</h4>
<ul>
<li>Define redis key
<ul>
<li>A user follows: <strong>followee:userId:entityType -&gt; zset(entityId, date)</strong></li>
<li>An entity being followed by: <strong>follower:entityType:entityId -&gt; zset(userId, date)</strong></li>
</ul>
</li>
<li>Define a service called <strong>FollowService</strong>
<ul>
<li>Define a method called <strong>follow()</strong> by using transaction management</li>
<li>Define a method called <strong>unFollow()</strong> by using transaction management</li>
</ul>
</li>
<li>Defind a controller called <strong>FollowController</strong>
<ul>
<li>Define an asynchronous method called <strong>follow()</strong></li>
<li>Define an asynchronous method called <strong>unFollow()</strong></li>
<li>Define a method called <strong>findFolloweeCount()</strong> to count the followee for a user</li>
<li>Define a method called <strong>findFollowerCount()</strong> to count the follower for a user</li>
<li>Define a method called <strong>hasFollowed()</strong> to check if the user has followed the entity</li>
</ul>
</li>
<li>Modify the method <strong>getProfilePage()</strong> in the <strong>UserController</strong> to:
<ul>
<li>Count the followee number</li>
<li>Count the follower number</li>
<li>Check if the user has followed the entity or not</li>
</ul>
</li>
<li>Connect with the frontend page</li>
</ul>
<p><br /></p>
<h2 id="2023-01-27">2023-01-27</h2>
<h4 id="likes-that-i-received">Likes that I received</h4>
<ul>
<li>Add a method for redis key
<ul>
<li>Define a method called <strong>getUserLikeKey()</strong> to get the redis key for users (like:user:userId)</li>
</ul>
</li>
<li>Refactor the method <strong>like()</strong>
<ul>
<li>Use transaction management to ensure the execution of 2 consecutive database operations</li>
<li>Get <strong>entityLikeKey</strong> and <strong>userLikeKey</strong>
<ul>
<li>Add a parameter called <strong>entityUserId</strong> into the function signature</li>
</ul>
</li>
<li>Check if the entity is liked or not
<ul>
<li>put the code inside of <strong>operations.multi()</strong> and <strong>return operations.exec()</strong></li>
<li>Add / remove the user id to / from <strong>entityLikeKey</strong></li>
<li>Increment / decrement the variable <strong>userLikeKey</strong></li>
</ul>
</li>
</ul>
</li>
<li>Define a method called <strong>findUserLikeCount()</strong> to count the number of likes that a user received
<ul>
<li>Type cast the Object type to Integer type</li>
<li>Return the Integer if it is not a null. Otherwise, return 0</li>
</ul>
</li>
<li>Refactor <strong>likeController</strong>
<ul>
<li>Modify the frontend (HTML, js) to pass the user id of the entity</li>
</ul>
</li>
</ul>
<h4 id="personal-profile">Personal Profile</h4>
<ul>
<li>Invoke the method <strong>getProfilePage()</strong> to pass the user and its count of likes received to the frontend profile page</li>
<li>Modify the index and the profile pages</li>
</ul>
<p><br /></p>
<h2 id="2023-01-20">2023-01-20</h2>
<h4 id="like">Like</h4>
<ul>
<li>Develop a utility for redis key
<ul>
<li>Define a method to get the key for entities that are up voted (format: like:entity:entityType:entityId)</li>
</ul>
</li>
<li>Develop a service for redis key
<ul>
<li>Define a method called &lsquo;like()&rsquo; to let the user up vote
<ul>
<li>If the user has liked the post before, remove the user id from the set.</li>
<li>Else add the user id into the set.</li>
</ul>
</li>
<li>Define a method called &lsquo;findEntityLikeCount()&rsquo; to count the number of likes that an entity receives</li>
<li>Define a method called &lsquo;findEntityLikeStatus()&rsquo; to check if the user liked the entity before or not</li>
</ul>
</li>
<li>Develop a controller for &lsquo;like&rsquo;
<ul>
<li>Invoke the method called &lsquo;like()&rsquo; to let the user like the post</li>
<li>Invoke the method called &lsquo;findEntityLikeCount()&rsquo; to count the number of likes that an entity receives</li>
<li>Invoke the method called &lsquo;findEntityLikeStatus()&rsquo; to check if the user liked the entity before or not</li>
<li>Send back the JSON format of these information</li>
</ul>
</li>
<li>Connect with frontend pages</li>
</ul>
<p><br /></p>
<h2 id="2023-01-19">2023-01-19</h2>
<h4 id="integrating-redis-with-spring">Integrating Redis with Spring</h4>
<ul>
<li>Load <strong>spring-boot-starter-data-redis</strong> from Maven Repository</li>
<li>Configure for Redis
<ul>
<li>Add configuration in <strong>application.properties</strong>
<ul>
<li>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="n">spring</span><span class="o">.</span><span class="na">redis</span><span class="o">.</span><span class="na">database</span> <span class="o">=</span> <span class="n">11</span>
  <span class="n">spring</span><span class="o">.</span><span class="na">redis</span><span class="o">.</span><span class="na">host</span> <span class="o">=</span> <span class="n">localhost</span>
  <span class="n">spring</span><span class="o">.</span><span class="na">redis</span><span class="o">.</span><span class="na">port</span> <span class="o">=</span> <span class="n">6379</span>
</code></pre></div></li>
</ul>
</li>
<li>Create a configuration file for Redis
<ul>
<li>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="nd">@Configuration</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisConfig</span> <span class="o">{</span>

      <span class="nd">@Bean</span>
      <span class="kd">public</span> <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">redisTemplate</span><span class="o">(</span><span class="n">RedisConnectionFactory</span> <span class="n">factory</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">template</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RedisTemplate</span><span class="o">&lt;&gt;();</span>
          <span class="n">template</span><span class="o">.</span><span class="na">setConnectionFactory</span><span class="o">(</span><span class="n">factory</span><span class="o">);</span>

          <span class="c1">// Specify a way for serialize
</span><span class="c1"></span>          <span class="c1">// Key:
</span><span class="c1"></span>          <span class="n">template</span><span class="o">.</span><span class="na">setKeySerializer</span><span class="o">(</span><span class="n">RedisSerializer</span><span class="o">.</span><span class="na">string</span><span class="o">());</span>
          <span class="c1">// Value:
</span><span class="c1"></span>          <span class="n">template</span><span class="o">.</span><span class="na">setValueSerializer</span><span class="o">(</span><span class="n">RedisSerializer</span><span class="o">.</span><span class="na">json</span><span class="o">());</span>
          <span class="c1">// Hash:
</span><span class="c1"></span>          <span class="n">template</span><span class="o">.</span><span class="na">setHashKeySerializer</span><span class="o">(</span><span class="n">RedisSerializer</span><span class="o">.</span><span class="na">string</span><span class="o">());</span>
          <span class="c1">// Hash-Value:
</span><span class="c1"></span>          <span class="n">template</span><span class="o">.</span><span class="na">setHashValueSerializer</span><span class="o">(</span><span class="n">RedisSerializer</span><span class="o">.</span><span class="na">json</span><span class="o">());</span>

          <span class="n">template</span><span class="o">.</span><span class="na">afterPropertiesSet</span><span class="o">();</span>
          <span class="k">return</span> <span class="n">template</span><span class="o">;</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-18">2023-01-18</h2>
<h4 id="redis-basis">Redis basis</h4>
<ul>
<li>Redis is an in-memory data structure store, used as a distributed, in-memory key–value database, cache and message broker, with optional durability. Redis supports different kinds of abstract data structures, such as strings, lists, maps, sets, sorted sets, HyperLogLogs, bitmaps, streams, and spatial indices.</li>
<li>Redis can be utilized for implementing cache, ranking list, counter, social networking, and message list.</li>
<li>Redis persistence: Persistence refers to the writing of data to durable storage, such as a solid-state disk (SSD). Redis provides a range of persistence options. These include:
<ul>
<li>RDB (Redis Database): RDB persistence performs point-in-time snapshots of your dataset at specified intervals.</li>
<li>AOF (Append Only File): AOF persistence logs every write operation received by the server. These operations can then be replayed again at server startup, reconstructing the original dataset. Commands are logged using the same format as the Redis protocol itself.</li>
</ul>
</li>
<li>Commands for Database:
<ul>
<li>Run Redis in the foreground: <strong>brew services start redis</strong></li>
<li>Connect to Redis: <strong>redis-cli</strong></li>
<li>Stop the service: <strong>brew services stop redis</strong></li>
<li>Select the Redis logical database: <strong>SELECT index</strong></li>
<li>Flush database: <strong>flushdb</strong></li>
<li>Get all keys of current logical database: <strong>keys *</strong></li>
<li>Get all keys with names starting with &lsquo;test&rsquo; of current logical database: <strong>keys test*</strong></li>
<li>Check the type of the key test:user: <strong>type test:user</strong></li>
<li>Check if the key test:user exists or not: <strong>exists test:user</strong></li>
<li>Delete the key test:user: <strong>del test:user</strong></li>
<li>Let the key test:students get expired after 10 seconds: <strong>expire test:students 10</strong></li>
</ul>
</li>
<li>Commands for String Type:
<ul>
<li>Set a pair of key and value: <strong>set test:count 1</strong></li>
<li>Get the value of a key: <strong>get test:count</strong></li>
<li>Increase the value of a key: <strong>incr test:count</strong></li>
<li>Decrease the value of a key: <strong>decr test:count</strong></li>
</ul>
</li>
<li>Commands for Hash type:
<ul>
<li>Set a pair of key and value for test:user: <strong>hset test:user id 1</strong></li>
<li>Get the key value of a pair for test:user: <strong>hget test:user id</strong></li>
</ul>
</li>
<li>Commands for List type:
<ul>
<li>Define a list test:ids and push some elements from the left: <strong>lpush test:ids 101 102 103</strong></li>
<li>Get the size of the list test:ids: <strong>llen test:ids</strong></li>
<li>Get the element of the list test:ids based on the index: <strong>lindex test:ids 0</strong></li>
<li>Get elements of the list test:ids based on the range: <strong>lrange test:ids 0 2</strong></li>
<li>Pop an element of the list test:ids from the right: <strong>rpop test:ids</strong></li>
</ul>
</li>
<li>Commands for Set type:
<ul>
<li>Define a set test:teachers and add some elements: <strong>sadd test:teachers Jason Kevin Joey Louis Bob</strong></li>
<li>Get the number of elements from the set test:teachers: <strong>scard test:teachers</strong></li>
<li>Randomly pop an element from the set test:teachers: <strong>spop test:teachers</strong></li>
<li>Check the remaining elements from the set test:teachers: <strong>smembers test:teachers</strong></li>
</ul>
</li>
<li>Commands for Sorted Set:
<ul>
<li>Define a sorted set and store elements and their weights: <strong>zadd test:students 10 aaa 20 bbb 30 ccc 40 ddd 50 eee</strong></li>
<li>Get the number of elements from the sorted set test:students: <strong>zcard test:students</strong></li>
<li>Get the weight of an element aaa from the sorted set test:students: <strong>zscore test:students aaa</strong></li>
<li>Get the ranking of an element ccc from the sorted set test:students: <strong>zrank test:students ccc</strong>
<ul>
<li>The ranking is from small weights to big weights, starting from ranking 0.</li>
</ul>
</li>
<li>Get elements based on the the range of ranking from the sorted set test:students: <strong>zrange test:students 0 2</strong></li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-17">2023-01-17</h2>
<h4 id="logging-information">Logging Information</h4>
<ul>
<li>AOP (Aspect Oriented Programming): In computing, aspect-oriented programming (AOP) is a programming paradigm that aims to increase modularity by allowing the separation of cross-cutting concerns. It does so by adding behavior to existing code (an advice) without modifying the code itself, instead separately specifying which code is modified via a &ldquo;pointcut&rdquo; specification, such as &ldquo;log all function calls when the function&rsquo;s name begins with &lsquo;set&rsquo;&quot;. This allows behaviors that are not central to the business logic (such as logging) to be added to a program without cluttering the code core to the functionality.</li>
<li>Implementation of AOP:
<ul>
<li>AspectJ: It expands Java, defines AOP syntax. AspectJ weaves code in the compiling stage to generate class files that follow the rule of Java byte code.</li>
<li>Spring AOP: Spring AOP is purely based on Java. It weaves code in the running stage by the way of proxy (JDK dynamic proxy (by default), CGLib dynamic proxy). It only supports join points with method type.</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-16">2023-01-16</h2>
<h4 id="handle-exceptions">Handle exceptions</h4>
<ul>
<li>We handle exceptions at the display layer by redirecting the user to some specific pages</li>
<li>Make sure the <strong>error</strong> folder is under the <strong>templates</strong> folder and the name of those HTML files is <strong>XXX.html</strong> (XXX is the error code, e.g 404, 500)</li>
<li>Make an folder called <strong>advice</strong> under the <strong>controller</strong> folder and define a class called <strong>ExceptionAdvice</strong></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">// Handle exceptions for all classes with &#34;Controller&#34; annotation
</span><span class="c1"></span><span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">annotations</span> <span class="o">=</span> <span class="n">Controller</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExceptionAdvice</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="o">(</span><span class="n">Logger</span><span class="o">)</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">ExceptionAdvice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@ExceptionHandler</span><span class="o">({</span><span class="n">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">})</span> <span class="c1">// Handle all exception classes
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleException</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">// Logging errors
</span><span class="c1"></span>        <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;500: &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">StackTraceElement</span> <span class="n">element</span> <span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">getStackTrace</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="c1">// Check if it is an asynchronous request or not
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">xRequestedWith</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="s">&#34;x-requested-with&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="s">&#34;XMLHttpRequest&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">xRequestedWith</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// If it is an asynchronous request
</span><span class="c1"></span>            <span class="c1">// Return a plain text for AJAX to convert it to JSON format 
</span><span class="c1"></span>            <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">&#34;application/plain;charset=utf-8&#34;</span><span class="o">);</span>
            <span class="n">PrintWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
            <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">CommunityUtil</span><span class="o">.</span><span class="na">getJSONString</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;Server Error!&#34;</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// If it is a normal request
</span><span class="c1"></span>            <span class="c1">// Redirect the user to error pages
</span><span class="c1"></span>            <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getContextPath</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;/error&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p><br /></p>
<h2 id="2023-01-13">2023-01-13</h2>
<h4 id="send-message">Send message</h4>
<ul>
<li>Data Layer
<ul>
<li>Insert a message</li>
<li>Update message status (unread -&gt; read)</li>
</ul>
</li>
<li>Service Layer
<ul>
<li>Develop <strong>addMessage()</strong> method
<ul>
<li>Filter HTML labels for safety concerns</li>
<li>Filter sensitive words of the comment content</li>
</ul>
</li>
<li>Develop <strong>readMessage()</strong> method
<ul>
<li>Invoke the method defined in the mapper file</li>
</ul>
</li>
</ul>
</li>
<li>Display Layer
<ul>
<li>Develop asynchronous method <strong>sendMessage()</strong></li>
<li>Modify js file to send the message using AJAX</li>
</ul>
</li>
</ul>
<h4 id="read-message">Read message</h4>
<ul>
<li>Display Layer
<ul>
<li>Define a method <strong>getMessageIds()</strong> to collect all message ids that need to be set to <em>read</em> status
<ul>
<li>Pass into a message list</li>
<li>Collect message ids if the current user is the receiver of the message and the message status is <em>unread</em></li>
</ul>
</li>
<li>Invoke the method <strong>getMessageIds()</strong> inside of the method <strong>getMessageDetail()</strong>
<ul>
<li>If the list collected is not empty, invoke <strong>readMessage()</strong> method to change the status of those messages</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-12">2023-01-12</h2>
<h4 id="message-list">Message List</h4>
<ul>
<li>Data Layer
<ul>
<li>Get the latest message for each conversation of the user</li>
<li>Get the number of conversations of the user</li>
<li>Get all messages of a particular conversation</li>
<li>Get the number of messages of a particular conversation</li>
<li>Get the number of unread messages (from a particular conversation or all conversations)</li>
</ul>
</li>
<li>Service Layer
<ul>
<li>Use methods defined in the mapper file</li>
</ul>
</li>
<li>Display Layer
<ul>
<li>Set page limit information</li>
<li>Define a List&lt;Map&lt;String, Object&raquo; called conversations, each map inside contains:
<ul>
<li>&ldquo;conversation&rdquo;: the latest message of one conversation</li>
<li>&ldquo;messageCount&rdquo;: the number of messages of the conversation</li>
<li>&ldquo;unreadCount&rdquo;: the number of unread message of the conversation</li>
<li>&ldquo;target&rdquo;: another user of the conversation</li>
</ul>
</li>
<li>Get the total number of unread messages of all conversations</li>
<li>Connect with the frontend page</li>
</ul>
</li>
</ul>
<h4 id="display-specific-message">Display specific message</h4>
<ul>
<li>Display Layer
<ul>
<li>Set page limit information</li>
<li>Define a List&lt;Map&lt;String, Object&raquo; called messages, each map inside contains:
<ul>
<li>&ldquo;message&rdquo;: a message of the conversation</li>
<li>&ldquo;fromUser&rdquo;: the user entity who sent this message</li>
</ul>
</li>
<li>Get the target user of this conversation (relative to the user itself)</li>
<li>Connect with the frontend page</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-11">2023-01-11</h2>
<h4 id="add-comments">Add comments</h4>
<ul>
<li>Data Layer
<ul>
<li>Insert new comment into database</li>
<li>Update the number of comments</li>
</ul>
</li>
<li>Service Layer
<ul>
<li>Use transaction management to ensure two transactions (insert comment, update comment number) can success at the same time</li>
<li>Insert the comment
<ul>
<li>Filter HTML labels for safety concerns</li>
<li>Filter sensitive words of the comment content</li>
<li>Invoke the method from the mapper file to insert the comment</li>
</ul>
</li>
<li>Update the number of comments when the comment is made to a post</li>
</ul>
</li>
<li>Display Layer
<ul>
<li>Set some attributes to the comment entity</li>
<li>Invoke the method from the service file to insert the comment</li>
<li>Redirect to the discuss detail page based on the id of the discuss post</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-08">2023-01-08</h2>
<h4 id="display-post-comments">Display post comments</h4>
<ul>
<li>Data Layer
<ul>
<li>Based on the entity to fetch one page comments</li>
<li>Based on the entity to fetch the total number of comments</li>
</ul>
</li>
<li>Service Layer
<ul>
<li>Develop the service of handling fetched comments</li>
<li>Develop the service of handling the number of fetched comments</li>
</ul>
</li>
<li>Display Layer
<ul>
<li>Logic inside of the controller
<ul>
<li>Define <strong>commentVoList</strong> to collect commentVo (view object, Map&lt;String, Object&gt;), it contains:
<ul>
<li>&ldquo;comment&rdquo;: the content of the comment to the post</li>
<li>&ldquo;user&rdquo;: the user who made this comment</li>
<li>&ldquo;replyCount&rdquo;: the number of replies to this comment</li>
<li>&ldquo;replies&rdquo;: <strong>replyVoList</strong> which collects replyVo (view object, Map&lt;String, Object&gt;), it contains:
<ul>
<li>&ldquo;reply&rdquo;: the content of the reply to the comment</li>
<li>&ldquo;user&rdquo;: the user who made this reply</li>
<li>&ldquo;target&rdquo;: the target of this reply (reply to the post or reply to other users)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Display the post as well as its comments</li>
</ul>
</li>
</ul>
<p><mark>Trouble Shooting:</mark></p>
<ul>
<li>Issue: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; bad SQL grammar
<ul>
<li>To address this issue, remember to put a <strong>comma</strong> between two parameters of &lsquo;limit&rsquo; keyword in the selection query.</li>
</ul>
</li>
<li>Issue: org.apache.ibatis.executor.ExecutorException: A query was run and no Result Maps were found for the Mapped Statement &lsquo;io.github.jiajun2001.community.community.dao.CommentMapper.selectCountByEntity&rsquo;.  It&rsquo;s likely that neither a Result Type nor a Result Map was specified.
<ul>
<li>To address this issue, remember to specify the <strong>resultType</strong> inside of the SQL label of XML file.</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2023-01-04">2023-01-04</h2>
<h4 id="transaction-maganement">Transaction Maganement</h4>
<ul>
<li>Transactions are a set of operations used to perform a logical set of work. A transaction usually means that the data in the database has changed. One of the major uses of DBMS is to protect the user’s data from system failures. It is done by ensuring that all the data is restored to a consistent state when the computer is restarted after a crash. The transaction is any one execution of the user program in a DBMS. Executing the same program multiple times will generate multiple transactions.</li>
<li>ACID Properties are used for maintaining the integrity of database during transaction processing. ACID in DBMS stands for Atomicity, Consistency, Isolation, and Durability.
<ul>
<li>Atomicity: A transaction is a single unit of operation. You either execute it entirely or do not execute it at all. There cannot be partial execution.</li>
<li>Consistency: Once the transaction is executed, it should move from one consistent state to another.</li>
<li>Isolation: Transaction should be executed in isolation from other transactions (no Locks). During concurrent transaction execution, intermediate transaction results from simultaneously executed transactions should not be made available to each other. (Level 0,1,2,3)</li>
<li>Durability: · After successful completion of a transaction, the changes in the database should persist. Even in the case of system failures.</li>
</ul>
</li>
</ul>
<p><img src="/JavaCommunity/transaction1.png" alt="image">
<img src="/JavaCommunity/transaction2.png" alt="image">
<img src="/JavaCommunity/transaction3.png" alt="image"></p>
<ul>
<li>
<p>Mechanism of transaction management</p>
<ul>
<li>Lock-based protocols help you to manage the order between the conflicting transactions when they will execute. Timestamp-based protocols manage conflicts as soon as an operation is created.</li>
<li>Lock-based
<ul>
<li>Shared Lock: A shared lock is also called a Read-only lock. With the shared lock, the data item can be shared between transactions. This is because you will never have permission to update data on the data item.</li>
<li>Exclusive Lock: With the Exclusive Lock, a data item can be read as well as written. This is exclusive and can’t be held concurrently on the same data item. Transactions may unlock the data item after finishing the ‘write’ operation.</li>
</ul>
</li>
<li>Timestamp-based:
<ul>
<li>Timestamp based Protocol in DBMS is an algorithm which uses the System Time or Logical Counter as a timestamp to serialize the execution of concurrent transactions. The Timestamp-based protocol ensures that every conflicting read and write operations are executed in a timestamp order.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Two ways of managing transactions</p>
<ul>
<li>Declarative Transactions
<ul>
<li>Declare the attributes of a transaction for one method using XML configuration</li>
<li>Using annotation to declare the attributes of a transaction for one method</li>
</ul>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Transactional</span><span class="o">(</span><span class="n">isolation</span> <span class="o">=</span> <span class="n">Isolation</span><span class="o">.</span><span class="na">READ_COMMITTED</span><span class="o">,</span> <span class="n">propagation</span> <span class="o">=</span> <span class="n">Propagation</span><span class="o">.</span><span class="na">REQUIRED</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Object</span> <span class="nf">save1</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Add a new user
</span><span class="c1"></span>    <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;alpha&#34;</span><span class="o">);</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setSalt</span><span class="o">(</span><span class="n">CommunityUtil</span><span class="o">.</span><span class="na">generateUUID</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">5</span><span class="o">));</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">CommunityUtil</span><span class="o">.</span><span class="na">md5</span><span class="o">(</span><span class="s">&#34;123&#34;</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getSalt</span><span class="o">()));</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&#34;alpha@qq.com&#34;</span><span class="o">);</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setHeaderURL</span><span class="o">(</span><span class="s">&#34;http://image.newcoder.com/head/99t.png&#34;</span><span class="o">);</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
    <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

    <span class="c1">// Add a new post
</span><span class="c1"></span>    <span class="n">DiscussPost</span> <span class="n">discussPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DiscussPost</span><span class="o">();</span>
    <span class="n">discussPost</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="n">discussPost</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Hello&#34;</span><span class="o">);</span>
    <span class="n">discussPost</span><span class="o">.</span><span class="na">setContent</span><span class="o">(</span><span class="s">&#34;NEW NEW USER&#34;</span><span class="o">);</span>
    <span class="n">discussPost</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
    <span class="n">discussPostMapper</span><span class="o">.</span><span class="na">insertDiscussPost</span><span class="o">(</span><span class="n">discussPost</span><span class="o">);</span>

    <span class="c1">// Create an error, see if it can roll back
</span><span class="c1"></span>    <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&#34;abc&#34;</span><span class="o">);</span>

    <span class="k">return</span> <span class="s">&#34;ok&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>Programmatic Transactions
<ul>
<li>Using TransactionTemplate to manage transactions</li>
</ul>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="n">TransactionTemplate</span> <span class="n">transactionTemplate</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="n">Object</span> <span class="nf">save2</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">transactionTemplate</span><span class="o">.</span><span class="na">setIsolationLevel</span><span class="o">(</span><span class="n">TransactionDefinition</span><span class="o">.</span><span class="na">ISOLATION_READ_COMMITTED</span><span class="o">);</span>
    <span class="n">transactionTemplate</span><span class="o">.</span><span class="na">setPropagationBehavior</span><span class="o">(</span><span class="n">TransactionDefinition</span><span class="o">.</span><span class="na">PROPAGATION_REQUIRED</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">transactionTemplate</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="n">TransactionCallback</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="nf">doInTransaction</span><span class="o">(</span><span class="n">TransactionStatus</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Add a new user
</span><span class="c1"></span>            <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;beta&#34;</span><span class="o">);</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setSalt</span><span class="o">(</span><span class="n">CommunityUtil</span><span class="o">.</span><span class="na">generateUUID</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">5</span><span class="o">));</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">CommunityUtil</span><span class="o">.</span><span class="na">md5</span><span class="o">(</span><span class="s">&#34;123&#34;</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getSalt</span><span class="o">()));</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&#34;beta@qq.com&#34;</span><span class="o">);</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setHeaderURL</span><span class="o">(</span><span class="s">&#34;http://image.newcoder.com/head/999t.png&#34;</span><span class="o">);</span>
            <span class="n">user</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
            <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

            <span class="c1">// Add a new post
</span><span class="c1"></span>            <span class="n">DiscussPost</span> <span class="n">discussPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DiscussPost</span><span class="o">();</span>
            <span class="n">discussPost</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
            <span class="n">discussPost</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Hola&#34;</span><span class="o">);</span>
            <span class="n">discussPost</span><span class="o">.</span><span class="na">setContent</span><span class="o">(</span><span class="s">&#34;NEW NEW USER USER&#34;</span><span class="o">);</span>
            <span class="n">discussPost</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
            <span class="n">discussPostMapper</span><span class="o">.</span><span class="na">insertDiscussPost</span><span class="o">(</span><span class="n">discussPost</span><span class="o">);</span>

            <span class="c1">// Create an error, see if it can roll back
</span><span class="c1"></span>            <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&#34;abc&#34;</span><span class="o">);</span>

            <span class="k">return</span> <span class="s">&#34;ok&#34;</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">});</span>
<span class="o">}</span>
</code></pre></div></li>
</ul>
<p><br /></p>
<h2 id="2023-01-03">2023-01-03</h2>
<h4 id="view-post-content">View post content</h4>
<ul>
<li>Add methods to <strong>DiscussPostMapper</strong>, <strong>DiscussPostService</strong>, <strong>DiscussPostController</strong></li>
<li>Modify <strong>index.html</strong> to add links to access the content of posts</li>
<li>Connect with <strong>discuss-detail.html</strong> frontend page</li>
</ul>
<p><mark>Trouble Shooting: </mark></p>
<ul>
<li>In the frontend page, make sure using the same attribute names of the model passed from the backend implementation.</li>
</ul>
<p><br /></p>
<h2 id="2023-01-02">2023-01-02</h2>
<h4 id="filter-sensitive-words">Filter sensitive words</h4>
<ul>
<li>Make a txt file defining the words that will be filtered</li>
<li>Define the prefix tree</li>
<li>Initialize the prefix tree based on words in the txt file defined before</li>
<li>Develop &lsquo;filter&rsquo; method
<ul>
<li>If original text is empty, return null</li>
<li>Define three pointers, two of them iterate through the original text, the other points to the prefix tree.</li>
<li>Handle symbol characters
<ul>
<li>If the prefix tree pointer points to the root node, skip</li>
<li>Else, move the end pointer one character to skip the symbol</li>
</ul>
</li>
<li>Check if a word is a sensitive
<ul>
<li>If the prefix tree pointer is null, append the character, move &lsquo;begin&rsquo; and &lsquo;end&rsquo; one character back, make the prefix tree pointer point to the root node.</li>
<li>If we detect a sensitive word, append a filtered word to the string builder, move &lsquo;end&rsquo; one character back, set &lsquo;begin&rsquo; to be &lsquo;end&rsquo;, make the prefix tree pointer point to the root node.</li>
<li>If we can find the character in the prefix tree and it is not a termination of a sensitive word, move &lsquo;end&rsquo; one character back.</li>
</ul>
</li>
<li>Handle the trailing characters because &lsquo;begin&rsquo; pointer may not be able to reach to the end</li>
</ul>
</li>
</ul>
<h4 id="optimization">Optimization</h4>
<ul>
<li>When constructing the prefix tree, convert all English letters to lowercase letters, so that the tool can filter sensitive words no matter if they are uppercase or lowercase.</li>
</ul>
<h4 id="posting">Posting</h4>
<ul>
<li>Load <strong>fastjson</strong> from Maven Repository</li>
<li>Add <strong>insertDiscussPost</strong> into <strong>DiscussPostMapper</strong></li>
<li>Add <strong>addDiscussPost</strong> into <strong>DiscussPostService</strong>
<ul>
<li>Check if discussPost is empty or not</li>
<li>Filter labels for safety</li>
<li>Filter sensitive words</li>
<li>Invoke <strong>insertDiscussPost</strong></li>
</ul>
</li>
<li>Develop <strong>DiscussPostController</strong>
<ul>
<li>Check if there exists a user</li>
<li>New a DiscussPost entity</li>
<li>Invoke <strong>addDiscussPost</strong></li>
</ul>
</li>
<li>Using jQuery to send AJAX to render the page without refreshing</li>
</ul>
<p><br /></p>
<h2 id="2023-01-01-happy-new-year">2023-01-01 (Happy New Year)</h2>
<h4 id="setting-a-new-profile-image">Setting a new profile image</h4>
<ul>
<li>Access the user setting page
<ul>
<li>Modify UserController</li>
</ul>
</li>
<li>Upload the new profile picture
<ul>
<li>Config for the path for storing images</li>
<li>Create a &lsquo;updateHeader&rsquo; method in UserService
<ul>
<li>Update headerURL attribute in the database</li>
</ul>
</li>
<li>Create a &lsquo;updateHeader&rsquo; method in UserController
<ul>
<li>public String uploadHeader(MultipartFile headerImage, Model model)</li>
<li>Check the validity of the headerImage
<ul>
<li>If it is empty, add attribute to the model and redirect to the same page</li>
<li>If the suffix of the image is empty, add attribute to the model and redirect to the same page</li>
</ul>
</li>
<li>Generate a new file name with a randomly generated string</li>
<li>Find the path of storing the file to the local server</li>
<li>Store the file to the local server</li>
<li>Update the path of the headerURL in the database</li>
<li>Redirect to the home page</li>
</ul>
</li>
</ul>
</li>
<li>Get the profile picture
<ul>
<li>Get the file address of the local server</li>
<li>Get the suffix of the file</li>
<li>Set response content type (pass the suffix of the file)</li>
<li>Use IO to load the image</li>
</ul>
</li>
<li>Connect with the frontend page
<ul>
<li>Add <strong>enctype=&quot;multipart/form-data&rdquo; th:action=&rdquo;@{/user/upload}</strong> to form labels</li>
</ul>
</li>
</ul>
<p><mark>Trouble Shooting: </mark></p>
<ul>
<li>To store profile images in the server side, we need to manually create a folder based on the path first.</li>
<li>In application.properties, when configurating for the path of uploading images, do not put double quotation marks around the path.</li>
</ul>
<h4 id="change-password">Change password</h4>
<ul>
<li>In UserService side
<ul>
<li>Check the validity of three inputs
<ul>
<li>If original password, new password and confirmed password are empty or not</li>
</ul>
</li>
<li>Check if original password is correct or not</li>
<li>Check if new password is strong enough or not</li>
<li>Check if new password is identical to confirmed password</li>
<li>Check if original password is the same as new password</li>
</ul>
</li>
<li>In UserController side
<ul>
<li>Fetch current user in the thread</li>
<li>Invoke <strong>changePassword</strong> method from userService</li>
</ul>
</li>
</ul>
<h4 id="optimization-1">Optimization</h4>
<ul>
<li>Restrict file types that can be uploaded</li>
<li>Delete old profile images to reduce the service load</li>
<li>Compress the image if its size is greater than 0.125 Mb (under construction)</li>
</ul>
<h4 id="check-login-status-restrict-users-who-have-not-logged-in-to-access-some-pages-using-specific-paths">Check login status (Restrict users who have not logged in to access some pages using specific paths)</h4>
<ul>
<li>Define an user-defined annotation</li>
<li>Put the annotation before methods that we want to intercept</li>
<li>Define an interceptor
<ul>
<li>Override its preHandle method
<ul>
<li>Check if <strong>handler</strong> is a HandlerMethod or not</li>
<li>Typecast <strong>handler</strong> from Object to HandlerMethod</li>
<li>Get the method from the HandlerMethod</li>
<li>Find if we can get the specific annotation from the method</li>
<li>If the method has the specific annotation and the user (from hostHolder) is not logged in
<ul>
<li>Redirect the visitor to the login page</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Config for interceptor
<ul>
<li>Exclude the access for static resource</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2022-12-31-last-day-of-2022">2022-12-31 (Last day of 2022)</h2>
<h4 id="display-login-information">Display login information</h4>
<p><img src="/JavaCommunity/displayLoginInfo.jpg" alt="image"></p>
<ul>
<li>Define an interceptor to handle logined users (It reduces the coupling of the system.)
<ul>
<li>preHandle() method
<ul>
<li>Get the cookie of the user</li>
<li>Use the cookie to get the loginTicket from login_ticket database</li>
<li>Validate the loginTicket
<ul>
<li>if the loginTicket is null or not</li>
<li>if the status of the loginTicket is 0 (valid) or not</li>
<li>if the loginTicket is expired or not</li>
</ul>
</li>
<li>Get the user based on the user_id from the loginTicket</li>
<li>Hold the user for current thread</li>
</ul>
</li>
<li>postHandle() method
<ul>
<li>Get the user from current thread</li>
<li>Validate user and modelAndView objects
<ul>
<li>Add the user to the model</li>
</ul>
</li>
</ul>
</li>
<li>afterCompletion() method
<ul>
<li>Clear the data</li>
</ul>
</li>
</ul>
</li>
<li>Config for the interceptor</li>
<li>Connect with the frontend page header
<ul>
<li>Based on if the attribute &lsquo;loginUser&rsquo; is null or not to display some labels</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2022-12-30">2022-12-30</h2>
<h4 id="login">Login</h4>
<ul>
<li>Build LoginTicket entity</li>
<li>Develop UserService to add a login function
<ul>
<li>Check empty values
<ul>
<li>Username, password</li>
</ul>
</li>
<li>Check if the account is existed or not</li>
<li>Check if the account is activated or not</li>
<li>Check if the password is correct or not
<ul>
<li>Encrypt the password and its salt and compare it with the one stored in the database</li>
</ul>
</li>
<li>Generate a &lsquo;session&rsquo; for the user
<ul>
<li>Create a LoginTicket object and store it in the database</li>
</ul>
</li>
</ul>
</li>
<li>Develop LoginController
<ul>
<li>Check captcha
<ul>
<li>Check if the captcha from the user and the captcha stored in the session are empty or not</li>
<li>Ckeck if they are equal or not (Do not distinguish between capital letters or lowercase letters)</li>
</ul>
</li>
<li>Check account and password
<ul>
<li>Set expiredSeconds based on if the user selected &lsquo;Remember me&rsquo; checkbox</li>
<li>Invoke <strong>userService.login</strong> method and use a map to receive the value</li>
<li>Based on if the map has the key called &lsquo;ticket&rsquo;, determine the following control logic:
<ul>
<li>If the map has the key &lsquo;ticket&rsquo;, set the cookie and redirect the user to the homepage. (Success)</li>
<li>If the map does not have this key, set attributes to <strong>model</strong> and stay in the login page. (Fail)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Connect with the frontend login page
<ul>
<li>Retain old information if login fails</li>
<li>Set th:text for div labels to display if there are some error messages</li>
<li>Control &lsquo;is-invalid&rsquo; attribute based on the existence of error messages</li>
</ul>
</li>
</ul>
<h4 id="logout">Logout</h4>
<ul>
<li>Get the ticket of the user from cookies</li>
<li>Set the <strong>status</strong> attribute of the ticket in the database to be 1</li>
<li>Redirect the user to the login page</li>
<li>Connect with the frontend page header</li>
</ul>
<p><br /></p>
<h2 id="2022-12-29">2022-12-29</h2>
<h4 id="session-management">Session Management</h4>
<p>Cookie operations</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/cookie/set&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">setCookie</span><span class="o">(</span><span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Create cookie
</span><span class="c1"></span>    <span class="n">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="s">&#34;code&#34;</span><span class="o">,</span> <span class="n">CommunityUtil</span><span class="o">.</span><span class="na">generateUUID</span><span class="o">());</span>
    <span class="c1">// Set cookie range
</span><span class="c1"></span>    <span class="n">cookie</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span><span class="s">&#34;/community/alpha&#34;</span><span class="o">);</span>
    <span class="c1">// Set cookie existing time (seconds)
</span><span class="c1"></span>    <span class="n">cookie</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="n">60</span> <span class="o">*</span> <span class="n">10</span><span class="o">);</span>
    <span class="c1">// Send cookie
</span><span class="c1"></span>    <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;set cookie&#34;</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/cookie/get&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getCookie</span><span class="o">(</span><span class="nd">@CookieValue</span><span class="o">(</span><span class="s">&#34;code&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">code</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">code</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;get cookie&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><p>Session mechanism
<img src="/JavaCommunity/session.png" alt="image">
Session operations</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/session/set&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">setSession</span><span class="o">(</span><span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
    <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;test&#34;</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;set session&#34;</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/session/get&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getSession</span><span class="o">(</span><span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
    <span class="k">return</span> <span class="s">&#34;get session&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><h4 id="generate-captcha">Generate captcha</h4>
<ul>
<li>Load <strong>Kaptcha » 2.3.2</strong> from Maven Repository</li>
<li>Config for this module manually</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">KaptchaConfig</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">Producer</span> <span class="nf">kaptchaProducer</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.image.width&#34;</span><span class="o">,</span> <span class="s">&#34;100&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.image.height&#34;</span><span class="o">,</span> <span class="s">&#34;40&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.textproducer.font.size&#34;</span><span class="o">,</span> <span class="s">&#34;32&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.textproducer.font.color&#34;</span><span class="o">,</span> <span class="s">&#34;0,0,0&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.textproducer.char.string&#34;</span><span class="o">,</span> <span class="s">&#34;0123456789abcdefghijklmnopqrstuvwxyz&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.textproducer.char.length&#34;</span><span class="o">,</span> <span class="s">&#34;4&#34;</span><span class="o">);</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;kaptcha.noise.impl&#34;</span><span class="o">,</span> <span class="s">&#34;com.google.code.kaptcha.impl.NoNoise&#34;</span><span class="o">);</span>

        <span class="n">DefaultKaptcha</span> <span class="n">kaptcha</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultKaptcha</span><span class="o">();</span>
        <span class="n">Config</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Config</span><span class="o">(</span><span class="n">properties</span><span class="o">);</span>
        <span class="n">kaptcha</span><span class="o">.</span><span class="na">setConfig</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">kaptcha</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>Inside of LoginController, define a method called &lsquo;getKaptcha&rsquo;
<ul>
<li>Use <strong>kaptchaProcuder.createText()</strong> to generate a kaptcha text</li>
<li>Use the text to generate a kaptcha image</li>
<li>Store the text into the session for future verification</li>
</ul>
</li>
<li>In login page, set the <strong>src</strong> attribute of <strong>img</strong> tag to be the path of <strong>getKaptcha</strong></li>
</ul>
<p><br /></p>
<h2 id="2022-12-28">2022-12-28</h2>
<h4 id="sign-up-module">Sign-up module</h4>
<ul>
<li>Clicking sign up button redirects the user to the page for signing up</li>
<li>Using form to submit data</li>
<li>Server verifies the validation of submitted data
<ul>
<li>If account, password, email are empty or not</li>
<li>If the account is existed or not</li>
<li>If the email is existed or not</li>
</ul>
</li>
<li>Create a new user
<ul>
<li>Generate a random salt for password</li>
<li>Use md5 to encrypt the password + salt and set this attribute</li>
<li>Set some attributes for this user
<ul>
<li>type, status, activation code, headerURL, createTime</li>
</ul>
</li>
<li>Insert the user into database</li>
</ul>
</li>
<li>Server sends verification emails
<ul>
<li>Set the activation URL for the email</li>
<li>Feed this variable into the template</li>
<li>Send the verification email</li>
</ul>
</li>
<li>Activate the account
<ul>
<li>Clicking the link in the verification email</li>
<li>LoginController will process the link
<ul>
<li>Invoke the &lsquo;activate&rsquo; method from UserService</li>
<li>Based on the code returned by UserService to generate operate-result.html</li>
</ul>
</li>
<li>Redirect to another page according to the activation result</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2022-12-27">2022-12-27</h2>
<h4 id="sending-email">Sending email</h4>
<ul>
<li>Open the <strong>SMTP</strong> service of your email account</li>
<li>Load <strong>Spring Boot Starter Mail</strong> from Maven Repository</li>
<li>Config <strong>MailProperties</strong></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">host</span> <span class="o">=</span> <span class="n">smtp</span><span class="o">.</span><span class="na">sina</span><span class="o">.</span><span class="na">com</span>
<span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">port</span> <span class="o">=</span> <span class="n">465</span>
<span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">xxxxx</span>
<span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">xxxxx</span>
<span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">protocal</span> <span class="o">=</span> <span class="n">smtps</span>
<span class="n">spring</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">properties</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">smtp</span><span class="o">.</span><span class="na">ssl</span><span class="o">.</span><span class="na">enable</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre></div><ul>
<li>Using <strong>MimeMessageHelper</strong> to assemble <strong>MimeMessage</strong>, and then invoke the method of <strong>mailSender.send(helper.getMimeMessage());</strong></li>
</ul>
<p><Mark>Trouble Shooting: </Mark></p>
<ul>
<li>org.springframework.mail.MailAuthenticationException: Authentication failed
<ul>
<li>This issue is caused by entering the wrong spring.mail.password in <strong>application.properties</strong> file. Note, you cannot fill in your email login password if you get an authentication code after setting up SMTP service of your email client side. Please fill in that property by the code you get.</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2022-12-26">2022-12-26</h2>
<h4 id="page-selection">Page selection</h4>
<ul>
<li>When a new page index is clicked, a new page&rsquo;s link will be generated (href).</li>
<li>This link will be parsed by HomeController and the &lsquo;current&rsquo; value will be fetched and passed to the page entity.</li>
<li>HomeController will get the post data and package them for thymeleaf view template to render.</li>
</ul>
<p><br /></p>
<h2 id="2022-12-25-merry-christmas">2022-12-25 (Merry Christmas!)</h2>
<h4 id="home-page">Home Page</h4>
<ul>
<li>Build entity file -&gt; Build mapper file -&gt; Build XML file</li>
</ul>
<p><mark>Trouble Shooting: </mark></p>
<ul>
<li>Do not put extra comma in SQL
<ul>
<li>e.g. order by type desc, create_time desc, (wrong)</li>
</ul>
</li>
<li>Make sure @Param(xx) matches to xx
<ul>
<li>e.g. int selectDiscussPostRows(@Param(&ldquo;usedId&rdquo;) int userId); (wrong)</li>
</ul>
</li>
<li>Remember to add the attribute to the model in controller files</li>
<li>When using thymeleaf inside of html labels, make sure you only type one &lsquo;{&rsquo; because of auto complete.
<ul>
<li><code>&lt;a href=&quot;#&quot; th:utext=&quot;${map.post.title}}&quot;&gt;&lt;/a&gt;</code> (Wrong)</li>
</ul>
</li>
<li>Another bug that I have met today is: <strong>Caused by: org.attoparser.ParseException</strong> when I was using thymeleaf engine to generate the content of the home page. This bug took me 3 hours to solve.
<ul>
<li>By analysis, this exception is caused by thymeleaf cannot get the object and therefore cannot parse it.</li>
<li>Since this exception happened to <strong>${map.user.headerURL}</strong> attribute, then I went to check my entity and realized that the getter and setter methods had wrong function names. I am not sure what caused this issue, because these getter and setter methods were generated by IntelliJ IDEA, but after modifying it, the application worked.</li>
<li>Issue: public String <strong>getheaderURL</strong>() &ndash;&gt; public String <strong>getHeaderURL</strong>()</li>
</ul>
</li>
</ul>
<p><br /></p>
<h2 id="2022-12-24">2022-12-24</h2>
<h4 id="mybatis">MyBatis</h4>
<p>MyBatis is an open source, lightweight, persistence framework. It is an alternative to JDBC and Hibernate. It automates the mapping between SQL databases and objects in Java, NET, and Ruby on Rails.</p>
<ul>
<li>Load <strong>MySQL Connector Java</strong> from Maven Repository</li>
<li>Load <strong>MyBatis Spring Boot Starter</strong> from Maven Repository</li>
<li>Create an entity file (A Java class) under the entity folder
<ul>
<li>It contains attributes of database columns, getter and setter methods, and toString method.</li>
</ul>
</li>
<li>Create a mapper file (A Java interface) under the dao (Data Access Object) folder
<ul>
<li>It contains methods for interfacing with the database</li>
<li>E.g. User selectById(int id); int updateHeader(int id, String headerUrl);</li>
</ul>
</li>
<li>Create a XML file under resources/mapper folder
<ul>
<li>Basic Structure:</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">    <span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">&#34;1.0&#34;</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span> <span class="o">?&gt;</span>
        <span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">mapper</span>
        <span class="n">PUBLIC</span> <span class="s">&#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;</span>
        <span class="s">&#34;https://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">mapper</span> <span class="n">namespace</span><span class="o">=</span><span class="s">&#34;org.mybatis.example.BlogMapper&#34;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">select</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;selectBlog&#34;</span> <span class="n">resultType</span><span class="o">=</span><span class="s">&#34;Blog&#34;</span><span class="o">&gt;</span>
            <span class="c1">// SQL.....
</span><span class="c1"></span>        <span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">mapper</span><span class="o">&gt;</span>
</code></pre></div></li>
</ul>
<p><Mark>Trouble Shooting: </Mark></p>
<ul>
<li>If you encounter &ldquo;MySQL ERROR 1045 (28000): Access denied for user ‘root’@’localhost’ (using password:YES)&rdquo; on Mac. Try to go to <strong>System Settings</strong> and find <strong>MySQL</strong> at the bottom of the left sidebar. Try to <strong>Initialize Database</strong> and set a new password.</li>
<li>For me, I had a problem of running tests for my mapper file. And then I found in my entity file, there was a typo of typing &lsquo;Date&rsquo; as &lsquo;Data&rsquo; which caused a wrong import of packages. (You need to be careful! This kind of bug will cause you tons of hours to debug because the terminal will just throw you a bunch of warning and error information.)</li>
<li>Please make sure the parameters of function signature in the mapper file match to the contents inside of the XML file labels.</li>
</ul>
<p><br /></p>
<h2 id="2022-12-23">2022-12-23</h2>
<h4 id="spring-ioc">Spring IoC</h4>
<ul>
<li>Inversion of Control &lt;- Dependency Injection &lt;- IoC Container</li>
<li>When a Spring container is created, it will automatically scan beans from different packages and assemble them into the container.</li>
<li>Classes with @Controller @Service @Component @Repository will be scanned by the container.</li>
<li>Advantage: Beans will rely on an interface instead of a particular implementing class.</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">    <span class="nd">@Autowired</span>
	<span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;alphaHibernate&#34;</span><span class="o">)</span>
	<span class="kd">private</span> <span class="n">AlphaDao</span> <span class="n">alphaDao</span><span class="o">;</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="n">AlphaService</span> <span class="n">alphaService</span><span class="o">;</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="n">SimpleDateFormat</span> <span class="n">simpleDateFormat</span><span class="o">;</span>

	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDI</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">alphaDao</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">alphaService</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">simpleDateFormat</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">()));</span>
	<span class="o">}</span>
    <span class="cm">/*
</span><span class="cm">    io.github.jiajun2001.community.community.dao.AlphaDaoHibernateImpl@5e9bbd9d
</span><span class="cm">    io.github.jiajun2001.community.community.service.AlphaService@4b87074a
</span><span class="cm">    2022-12-23 14:08:20
</span><span class="cm">    */</span>
</code></pre></div><h4 id="spring-mvc">Spring MVC</h4>
<p>Spring MVC is a library within the Spring framework that simplifies handling HTTP requests and responses. It’s built on the Servlet API and is an essential component of the Spring Framework. The MVC stands for Model-View-Controller, which is its core function, allowing separation of the business logic, presentation logic, and navigation logic.
<img src="/JavaCommunity/SpringMVC.png" alt="image"></p>
<p>Two ways of passing parameters into GET request</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">// /students?current=1&amp;limit=20
</span><span class="c1"></span><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/students&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getStudents</span><span class="o">(</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;current&#34;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&#34;1&#34;</span><span class="o">)</span> <span class="kt">int</span> <span class="n">current</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;limit&#34;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&#34;10&#34;</span><span class="o">)</span> <span class="kt">int</span> <span class="n">limit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Current: &#34;</span> <span class="o">+</span> <span class="n">current</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Limit: &#34;</span> <span class="o">+</span> <span class="n">limit</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;Some students!&#34;</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// /student/123
</span><span class="c1"></span><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/student/{id}&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getStudent</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ID: &#34;</span> <span class="o">+</span> <span class="n">id</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;a student!&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><p>Passing parameters into POST request</p>
<div class="highlight"><pre class="chroma"><code class="language-HTML" data-lang="HTML"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;/community/alpha/student&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
        Name: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
        Age: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;age&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Save&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/student&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">saveStudent</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Name: &#34;</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Age: &#34;</span> <span class="o">+</span> <span class="n">age</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;Success&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><p><Mark>Trouble Shooting: </Mark></p>
<ul>
<li>If you click the button and it does not respond. Go back to your HTML file and check if the type of the button is <strong>&lsquo;submit&rsquo;</strong> instead of &lsquo;button&rsquo;.</li>
</ul>
<p>Two ways of responding HTML page</p>
<div class="highlight"><pre class="chroma"><code class="language-HTML" data-lang="HTML"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span> <span class="na">xmlns:th</span><span class="o">=</span><span class="s">&#34;http:www.thymeleaf.org&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Teacher<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${name}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${age}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/teacher&#34;</span> <span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">ModelAndView</span> <span class="nf">getTeacher</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">ModelAndView</span> <span class="n">mav</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ModelAndView</span><span class="o">();</span>
    <span class="n">mav</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;Jason&#34;</span><span class="o">);</span>
    <span class="n">mav</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">21</span><span class="o">);</span>
    <span class="n">mav</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">&#34;/demo/view&#34;</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">mav</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/school&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getSchool</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;Adelaide Uni&#34;</span><span class="o">);</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">100</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&#34;/demo/view&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><p>Two ways of responding JSON format data</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/emp&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEmp</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">emp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">emp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;Jason&#34;</span><span class="o">);</span>
    <span class="n">emp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">21</span><span class="o">);</span>
    <span class="n">emp</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;salary&#34;</span><span class="o">,</span> <span class="n">200000</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">emp</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// {&#34;name&#34;:&#34;Jason&#34;,&#34;salary&#34;:200000,&#34;age&#34;:21}
</span><span class="c1"></span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/emps&#34;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getEmps</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">emp1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">emp1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;Jason&#34;</span><span class="o">);</span>
    <span class="n">emp1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">21</span><span class="o">);</span>
    <span class="n">emp1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;salary&#34;</span><span class="o">,</span> <span class="n">200000</span><span class="o">);</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">emp1</span><span class="o">);</span>

    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">emp2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">emp2</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;Kevin&#34;</span><span class="o">);</span>
    <span class="n">emp2</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="n">20</span><span class="o">);</span>
    <span class="n">emp2</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;salary&#34;</span><span class="o">,</span> <span class="n">190000</span><span class="o">);</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">emp2</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// [{&#34;name&#34;:&#34;Jason&#34;,&#34;salary&#34;:200000,&#34;age&#34;:21},{&#34;name&#34;:&#34;Kevin&#34;,&#34;salary&#34;:190000,&#34;age&#34;:20}]
</span></code></pre></div><p><br /></p>
<h2 id="2022-12-22">2022-12-22</h2>
<h4 id="download-and-config-apache-maven">Download and config Apache Maven</h4>
<p>Apache Maven is a software project management and comprehension tool. Based on the concept of a project object model (POM), Maven can manage a project&rsquo;s build, reporting and documentation from a central piece of information.</p>
<ul>
<li>Go to the website of Maven: <a href="https://maven.apache.org/download.cgi">https://maven.apache.org/download.cgi</a></li>
<li>Choose the version of Maven to download:
<ul>
<li>For Mac users: apache-maven-3.8.6-bin.tar.gz</li>
<li>For Windows users: apache-maven-3.8.6-bin.zip</li>
</ul>
</li>
<li>Unzip the compressed file</li>
<li>Set the environment path: e.g. export PATH=/Users/apple/apache-maven-3.8.6/bin:$PATH</li>
<li>Config the mirror repository:
<ul>
<li>conf -&gt; settings.xml</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;mirror&gt;</span>
        <span class="nt">&lt;id&gt;</span>alimaven<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;mirrorOf&gt;</span>central<span class="nt">&lt;/mirrorOf&gt;</span>
        <span class="nt">&lt;name&gt;</span>aliyun maven<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;url&gt;</span>https://maven.aliyun.com/repository/central<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/mirror&gt;</span>
</code></pre></div></li>
<li>Test by entering the command: mvn --version</li>
<li>Config IntelliJ IDEA CE for using Maven
<ul>
<li>Open IntelliJ IDEA CE</li>
<li>Preferences -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Maven</li>
<li>Set Maven home path</li>
<li>Override User setting file, after specifying the path of settings.xml file of your downloaded Maven folder</li>
<li>Apply -&gt; OK</li>
</ul>
</li>
</ul>
<h4 id="using-spring-initializr">Using Spring Initializr</h4>
<p>Spring Initializr is a web-based tool provided by the Pivotal Web Service. With the help of Spring Initializr, we can easily generate the structure of the Spring Boot Project. It offers extensible API for creating JVM-based projects.</p>
<p><img src="/JavaCommunity/SpringInitializr.png" alt="image"></p>
<p><Mark>Trouble Shooting: </Mark></p>
<ul>
<li>If the spring boot project does not run. Go to preference -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Maven. Set the Maven home path to <strong>Bundled (Maven 3)</strong>. And then click apply and ok.</li>
</ul></div>
    <div class="post__footer">
      

      
        <span><a class="tag" href="/tags/java/">Java</a><a class="tag" href="/tags/project/">Project</a></span>


      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        JZ Chan
        2023
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.7d3bf3472b73d9ba107b3de37d0df8fa736593a3c6638c95eaed42006bfc0193.js"
    integrity="sha256-fTvzRytz2boQez3jfQ34&#43;nNlk6PGY4yV6u1CAGv8AZM="
    crossorigin="anonymous"
  ></script></body>
</html>
